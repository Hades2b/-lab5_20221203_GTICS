<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Mis Mensajes</title>
    <link rel="stylesheet" href="/estilos.css">
</head>
<body>
<header th:replace="/header :: header"></header>

<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1>Mis Mensajes</h1>
                <span th:if="${listaMensajes!=null and !listaMensajes.isEmpty()}" class="badge badge-primary badge-pill"
                      th:text="${'Total: ' + listaMensajes.size()}">Total: 0</span>
            </div>

            <div th:if="${listaMensajes!=null and !listaMensajes.isEmpty()}" class="card shadow-sm">
                <div class="card-header bg-light">
                    <h5 class="card-title mb-0">Bandeja de Entrada</h5>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover table-striped mb-0">
                            <thead class="thead-dark">
                            <tr>
                                <th scope="col" class="text-center" style="width: 80px;">Regalo</th>
                                <th scope="col">Remitente</th>
                                <th scope="col">Contenido</th>
                                <th scope="col" class="text-center">Fecha</th>
                                <th scope="col" class="text-center">Acciones</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="mensaje : ${listaMensajes}" class="align-middle">
                                <!-- Columna del regalo -->
                                <td class="text-center">
                                    <div class="d-flex flex-column align-items-center">
                                        <i class="fas fa-gift fa-lg mb-1"
                                           th:style="'color: ' + ${mensaje.color} + ';'"
                                           th:classappend="${mensaje.regalo} ? 'text-primary' : 'text-muted'">
                                        </i>
                                        <small class="text-muted" th:text="${mensaje.regalo}">Tipo</small>
                                    </div>
                                </td>

                                <!-- Columna del remitente -->
                                <td>
                                    <div class="d-flex align-items-center">
                                        <i class="fas fa-user-circle text-primary mr-2"></i>
                                        <div>
                                            <strong th:text="${mensaje.remitente.nombre + ' ' + mensaje.remitente.apellido}">
                                                Nombre Remitente
                                            </strong>
                                            <br>
                                            <small class="text-muted" th:text="${mensaje.remitente.correo}">
                                                correo@ejemplo.com
                                            </small>
                                        </div>
                                    </div>
                                </td>

                                <!-- Columna del contenido (vista previa) -->
                                <td>
                                    <div class="mensaje-preview">
                                        <p class="mb-1 text-truncate" style="max-width: 250px;"
                                           th:text="${mensaje.contenido}">
                                            Contenido del mensaje aquí...
                                        </p>
                                        <small class="text-muted">
                                            <i class="fas fa-palette mr-1"></i>
                                            Color: <span th:text="${mensaje.color}">Color</span>
                                        </small>
                                    </div>
                                </td>

                                <!-- Columna de fecha -->
                                <td class="text-center">
                                    <div class="d-flex flex-column">
                                            <span class="font-weight-bold"
                                                  th:text="${#temporals.format(mensaje.fechaEnvio.toLocalDateTime(), 'dd/MM/yyyy')}">
                                                01/01/2024
                                            </span>
                                        <small class="text-muted"
                                               th:text="${#temporals.format(mensaje.fechaEnvio.toLocalDateTime(), 'HH:mm')}">
                                            12:00
                                        </small>
                                    </div>
                                </td>

                                <td class="text-center">
                                    <a th:href="@{'/mensajes/'+${mensaje.id}}" class="btn btn-primary btn-sm">Ver</a>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div th:if="${listaMensajes==null or listaMensajes.isEmpty()}" class="text-center py-5">
                <div class="card shadow-sm">
                    <div class="card-body py-5">
                        <h3 class="text-muted mb-3">No hay mensajes</h3>
                        <p class="text-muted">Tu bandeja de entrada está vacía.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

</body>
</html>